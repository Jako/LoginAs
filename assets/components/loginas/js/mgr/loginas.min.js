/*!
 * LoginAs - Login as manager user into frontend accounts without a password
 * Version: 1.0.1
 * Build date: 2025-08-14
 */
var loginas=function(o){loginas.superclass.constructor.call(this,o=o||{})};Ext.extend(loginas,Ext.Component,{initComponent:function(){this.stores={},this.ajax=new Ext.data.Connection({disableCaching:!0})},page:{},window:{},grid:{},tree:{},panel:{},combo:{},config:{},util:{},form:{}}),Ext.reg("loginas",loginas),LoginAs=new loginas,MODx.config.help_url="https://jako.github.io/LoginAs/usage/",LoginAs.combo.User=function(o){o=o||{},Ext.applyIf(o,{displayField:"username",valueField:"id",fields:["username","id"],pageSize:20,url:LoginAs.config.connectorUrl,baseParams:{action:"mgr/user/getlist",combo:!0},editable:!0,minChars:2,autoSelect:!1}),MODx.combo.User.superclass.constructor.call(this,o)},Ext.extend(LoginAs.combo.User,MODx.combo.ComboBox),Ext.reg("loginas-combo-user",LoginAs.combo.User),LoginAs.util.loginAs=function(){MODx.load({xtype:"loginas-window-login-as",title:_("loginas.login_as"),listeners:{success:{fn:function(){window.location.href=LoginAs.config.targetUrl},scope:this},failure:{fn:function(o){MODx.msg.alert(_("error"),o.message)},scope:this}}}).show()},LoginAs.window.loginAs=function(o){o=o||{},this.ident="loginas-window-login-as-"+Ext.id(),Ext.applyIf(o,{id:this.ident,url:LoginAs.config.connectorUrl,baseParams:{action:"mgr/user/loginas"},autoHeight:!0,closeAction:"close",cls:"modx-window loginas-window modx"+LoginAs.config.modxversion,buttons:[{text:_("cancel"),scope:this,handler:this.close},{text:_("loginas.login_as"),cls:"primary-button",scope:this,handler:this.submit}],fields:[{style:"margin-top: 15px",html:"<p>"+_("loginas.login_as_desc")+"</p>"},{xtype:"loginas-combo-user",fieldLabel:_("loginas.username"),name:"username",id:this.ident+"-username",allowBlank:!1,anchor:"100%",listeners:{afterrender:function(o){o.getEl().dom.setAttribute("data-1p-ignore","")}}}]}),LoginAs.window.loginAs.superclass.constructor.call(this,o)},Ext.extend(LoginAs.window.loginAs,MODx.Window,{}),Ext.reg("loginas-window-login-as",LoginAs.window.loginAs);